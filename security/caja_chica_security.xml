<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">

        <!-- Grupos de seguridad para Caja Chica -->
        <record id="group_petty_cash_user" model="res.groups">
            <field name="name">Usuario de Caja Chica</field>
            <field name="category_id" ref="base.module_category_accounting"/>
            <field name="comment">Puede crear y gestionar sus propias cajas chicas</field>
        </record>

        <record id="group_petty_cash_manager" model="res.groups">
            <field name="name">Gerente de Caja Chica</field>
            <field name="category_id" ref="base.module_category_accounting"/>
            <field name="implied_ids" eval="[(4, ref('group_petty_cash_user'))]"/>
            <field name="comment">Puede gestionar todas las cajas chicas y configuraciones</field>
        </record>

        <!-- Grupos de seguridad para Caja de Distribución -->
        <record id="group_distribution_cash_user" model="res.groups">
            <field name="name">Usuario de Caja de Distribución</field>
            <field name="category_id" ref="base.module_category_accounting"/>
            <field name="comment">Puede crear y gestionar sus propias cajas de distribución</field>
        </record>

        <record id="group_distribution_cash_manager" model="res.groups">
            <field name="name">Gerente de Caja de Distribución</field>
            <field name="category_id" ref="base.module_category_accounting"/>
            <field name="implied_ids" eval="[(4, ref('group_distribution_cash_user'))]"/>
            <field name="comment">Puede gestionar todas las cajas de distribución y configuraciones</field>
        </record>

        <!-- Grupos de seguridad para Caja de Logística -->
        <record id="group_logistics_cash_user" model="res.groups">
            <field name="name">Usuario de Caja de Logística</field>
            <field name="category_id" ref="base.module_category_accounting"/>
            <field name="comment">Puede crear y gestionar sus propias cajas de logística</field>
        </record>

        <record id="group_logistics_cash_manager" model="res.groups">
            <field name="name">Gerente de Caja de Logística</field>
            <field name="category_id" ref="base.module_category_accounting"/>
            <field name="implied_ids" eval="[(4, ref('group_logistics_cash_user'))]"/>
            <field name="comment">Puede gestionar todas las cajas de logística y configuraciones</field>
        </record>

        <!-- Reglas de registro para usuarios normales - Caja Chica -->
        <record id="petty_cash_user_rule" model="ir.rule">
            <field name="name">Caja Chica: Usuario puede ver solo sus cajas</field>
            <field name="model_id" ref="model_petty_cash"/>
            <field name="groups" eval="[(4, ref('group_petty_cash_user'))]"/>
            <field name="domain_force">[('responsible_id', '=', user.id)]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Reglas de registro para gerentes - Caja Chica -->
        <record id="petty_cash_manager_rule" model="ir.rule">
            <field name="name">Caja Chica: Gerente puede ver todas las cajas</field>
            <field name="model_id" ref="model_petty_cash"/>
            <field name="groups" eval="[(4, ref('group_petty_cash_manager'))]"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Reglas para líneas de caja chica -->
        <record id="petty_cash_line_user_rule" model="ir.rule">
            <field name="name">Líneas Caja Chica: Usuario puede ver solo las de sus cajas</field>
            <field name="model_id" ref="model_petty_cash_line"/>
            <field name="groups" eval="[(4, ref('group_petty_cash_user'))]"/>
            <field name="domain_force">[('petty_cash_id.responsible_id', '=', user.id)]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="petty_cash_line_manager_rule" model="ir.rule">
            <field name="name">Líneas Caja Chica: Gerente puede ver todas</field>
            <field name="model_id" ref="model_petty_cash_line"/>
            <field name="groups" eval="[(4, ref('group_petty_cash_manager'))]"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Reglas de registro para usuarios normales - Caja de Distribución -->
        <record id="distribution_cash_user_rule" model="ir.rule">
            <field name="name">Caja Distribución: Usuario puede ver solo sus cajas</field>
            <field name="model_id" ref="model_distribution_cash"/>
            <field name="groups" eval="[(4, ref('group_distribution_cash_user'))]"/>
            <field name="domain_force">[('responsible_id', '=', user.id)]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Reglas de registro para gerentes - Caja de Distribución -->
        <record id="distribution_cash_manager_rule" model="ir.rule">
            <field name="name">Caja Distribución: Gerente puede ver todas las cajas</field>
            <field name="model_id" ref="model_distribution_cash"/>
            <field name="groups" eval="[(4, ref('group_distribution_cash_manager'))]"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Reglas para líneas de caja de distribución -->
        <record id="distribution_cash_line_user_rule" model="ir.rule">
            <field name="name">Líneas Caja Distribución: Usuario puede ver solo las de sus cajas</field>
            <field name="model_id" ref="model_distribution_cash_line"/>
            <field name="groups" eval="[(4, ref('group_distribution_cash_user'))]"/>
            <field name="domain_force">[('distribution_cash_id.responsible_id', '=', user.id)]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="distribution_cash_line_manager_rule" model="ir.rule">
            <field name="name">Líneas Caja Distribución: Gerente puede ver todas</field>
            <field name="model_id" ref="model_distribution_cash_line"/>
            <field name="groups" eval="[(4, ref('group_distribution_cash_manager'))]"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Reglas de registro para usuarios normales - Caja de Logística -->
        <record id="logistics_cash_user_rule" model="ir.rule">
            <field name="name">Caja Logística: Usuario puede ver solo sus cajas</field>
            <field name="model_id" ref="model_logistics_cash"/>
            <field name="groups" eval="[(4, ref('group_logistics_cash_user'))]"/>
            <field name="domain_force">[('responsible_id', '=', user.id)]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Reglas de registro para gerentes - Caja de Logística -->
        <record id="logistics_cash_manager_rule" model="ir.rule">
            <field name="name">Caja Logística: Gerente puede ver todas las cajas</field>
            <field name="model_id" ref="model_logistics_cash"/>
            <field name="groups" eval="[(4, ref('group_logistics_cash_manager'))]"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Reglas para líneas de caja de logística -->
        <record id="logistics_cash_line_user_rule" model="ir.rule">
            <field name="name">Líneas Caja Logística: Usuario puede ver solo las de sus cajas</field>
            <field name="model_id" ref="model_logistics_cash_line"/>
            <field name="groups" eval="[(4, ref('group_logistics_cash_user'))]"/>
            <field name="domain_force">[('logistics_cash_id.responsible_id', '=', user.id)]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="logistics_cash_line_manager_rule" model="ir.rule">
            <field name="name">Líneas Caja Logística: Gerente puede ver todas</field>
            <field name="model_id" ref="model_logistics_cash_line"/>
            <field name="groups" eval="[(4, ref('group_logistics_cash_manager'))]"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Asignar grupos por defecto -->
        <record id="base.group_user" model="res.groups">
            <field name="implied_ids" eval="[(4, ref('group_petty_cash_user')), (4, ref('group_distribution_cash_user')), (4, ref('group_logistics_cash_user'))]"/>
        </record>

        <record id="account.group_account_manager" model="res.groups">
            <field name="implied_ids" eval="[(4, ref('group_petty_cash_manager')), (4, ref('group_distribution_cash_manager')), (4, ref('group_logistics_cash_manager'))]"/>
        </record>

    </data>
</odoo>